---
title: HMM学习笔记5——解码问题
mathjax: true
date: 2023-02-19 16:22:29
categories: 机器学习
description: 对于解码问题，我们常使用Viterbi算法解决，其一大应用便是对于无登录词情况下的句子分词
---

## 问题描述

给定$\lambda=(\pi,A,B)$和观测序列，求状态序列。即寻找一个最能解释已知观测序列的状态序列。

## Viterbi算法

很奇妙，Viterbi算法也是一种动态规划算法。

### 两个有点复杂的定义：

1. 令$\delta_t(i)$为所有能在时刻$t$到达状态$q_i$的路径的符合观测序列的概率的最大值。

    详细点说，这里的概率是对于一条能在时刻$t$到达状态$q_i$的路径，其观测序列正好满足给定观测序列的前$t$个的这个概率。

    而$\delta_t(i)$指的是所有路径上述概率的最大值。

    其存在递推公式：$\delta_{t+1}(i)=b_i(o_{t+1})\times \max(\delta_t(j)\times a_{ji})$，$j\in[1,N]$。

    即从时刻$t$在状态$q_j$转移到了时刻$t+1$在状态$q_i$，后面的$max$表示转移的概率，因为还需要满足在$t+1$时刻的观测结果符合所给序列，所以在前面乘上$b_i(o_{t+1})$

2. 令$\psi_t(i)$表示$\delta_t(i)$是从$t-1$时刻的哪个状态转移过来的。

### Viterbi流程：

1. 初始化：

    $\delta_1(i)=b_i(o_1)\times \pi_i$，$i\in[1,N]$

    $\psi_1(i)=0$

2. 递推计算：

    $\delta_{t+1}(i)=b_i(o_{t+1})\times \max(\delta_t(j)\times a_{ji})$，$j\in[1,N],t\in[1,N-1]$

    $\psi_{t+1}(i)=\arg\max(\delta_t(j)\times a_{ji})$，$\arg$表示满足条件的下标

3. 得到终值：

    $P^*=\max(\delta_T(i))$（如果只求路径的话$P^*$不太重要）

    $i_{T}^*=\arg\max(\delta_T(i))$

4. 根据终值回溯寻找答案路径：

    $i_t^*=\psi_{t+1}(i_{t+1}^*)$，$t\in[1,T-1]$


最后，$I=[i_1^*,i_2^*,\dots,i_T^*]$便是我们需要的最终答案，表示一个满足所给观测序列最有可能的状态序列。

​    

​    

​    

​    

